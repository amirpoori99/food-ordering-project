# 🍕 سیستم سفارش غذا

یک پلتفرم جامع سفارش غذا که به عنوان پروژه دانشگاهی برای درس برنامه‌نویسی پیشرفته توسعه یافته است. این سیستم دارای بک‌اند قدرتمند جاوا با Hibernate ORM و فرانت‌اند JavaFX برنامه‌ریزی شده است و معماری کاملاً چندلایه‌ای را پیاده‌سازی می‌کند.

## 🚀 وضعیت پروژه

**نسخه فعلی**: فاز 4 تکمیل شده ✅  
**پوشش تست**: 700+ تست موفق ✅  
**امتیاز دانشگاهی**: 47.5/60 امتیاز (79.2%)  

### ✅ ویژگی‌های تکمیل شده
- ✅ **مدیریت کاربران**: ثبت‌نام، ورود و مدیریت پروفایل کامل (72+ تست)
- ✅ **مدیریت رستوران**: منطق تجاری کامل رستوران (108+ تست)
- ✅ **مدیریت منو**: عملیات کامل منو با منطق تجاری (80+ تست)
- ✅ **جستجوی غذا**: جستجوی پیشرفته با فیلتر کلیدواژه و دسته‌بندی
- ✅ **مدیریت سفارش**: سبد خرید کامل و ثبت سفارش (75+ تست)
- ✅ **تاریخچه سفارش**: ردیابی و تاریخچه کامل سفارشات
- ✅ **سیستم پرداخت**: پردازش کامل پرداخت و مدیریت کیف پول (200+ تست) ✨ **جدید**
- ✅ **لایه داده**: مهاجرت کامل JPA با روابط پیچیده
- ✅ **لایه سرویس**: پیاده‌سازی کامل منطق تجاری برای تمام ویژگی‌های اصلی
- ✅ **لایه کنترلر**: REST API endpointهای کامل برای یکپارچگی فرانت‌اند ✨ **جدید**

### 🔄 در حال توسعه
- 🔄 **سیستم تحویل**: تخصیص پیک و ردیابی
- 🔄 **داشبورد ادمین**: مدیریت سیستم

### 📋 ویژگی‌های برنامه‌ریزی شده
- 📋 **فرانت‌اند JavaFX**: رابط کاربری کامل
- 📋 **سیستم اعلان**: اعلان‌های بلادرنگ
- 📋 **سیستم کوپن**: مدیریت تخفیف‌ها
- 📋 **سیستم نظرات**: امتیازدهی و نظرات کاربران

## 🏗️ معماری

### بک‌اند (جاوا + Hibernate)
```
backend/
├── src/main/java/com/myapp/
│   ├── common/
│   │   ├── models/             # موجودیت‌های JPA ✅
│   │   ├── exceptions/         # استثناهای سفارشی ✅
│   │   └── utils/              # ابزارهای کمکی ✅
│   ├── auth/                   # سیستم احراز هویت ✅
│   ├── restaurant/             # مدیریت رستوران ✅
│   ├── item/                   # مدیریت آیتم غذا ✅
│   ├── menu/                   # عملیات منو ✅
│   ├── order/                  # پردازش سفارش ✅
│   ├── payment/                # سیستم پرداخت ✅ ✨ جدید
│   └── ServerApp.java          # سرور HTTP ✅
└── src/test/java/              # 700+ تست جامع ✅
```

### فرانت‌اند (JavaFX) - برنامه‌ریزی شده
```
frontend-javafx/
├── src/main/java/com/myapp/ui/
│   ├── auth/                   # رابط کاربری ورود/ثبت‌نام
│   ├── restaurant/             # رابط کاربری رستوران
│   ├── order/                  # رابط کاربری مدیریت سفارش
│   ├── payment/                # رابط کاربری پرداخت
│   └── MainApp.java            # اپلیکیشن JavaFX
└── src/main/resources/fxml/    # طرح‌بندی‌های رابط کاربری
```

## 🛠️ فناوری‌ها

### بک‌اند
- **Java 17+**
- **Hibernate 6.4.4** (JPA ORM)
- **SQLite** (پایگاه داده)
- **Maven** (ابزار ساخت)
- **JUnit 5** (فریمورک تست)

### فرانت‌اند (برنامه‌ریزی شده)
- **JavaFX** (فریمورک رابط کاربری دسکتاپ)
- **FXML** (طرح‌بندی رابط کاربری)

### DevOps
- **Maven** (مدیریت وابستگی)

## 🚀 شروع کار

### پیش‌نیازها
- Java 17 یا بالاتر
- Maven 3.6+

### 1. کلون کردن مخزن
```bash
git clone <repository-url>
cd food-ordering-project
```

### 2. ساخت پروژه
```bash
cd backend
mvn clean compile
```

### 3. اجرای تست‌ها
```bash
mvn test
```
خروجی مورد انتظار: `Tests run: 700+, Failures: 0, Errors: 0`

### 4. راه‌اندازی سرور بک‌اند
```bash
mvn exec:java -Dexec.mainClass="com.myapp.ServerApp"
```



## 📊 پوشش تست

پروژه پوشش تست جامعی در تمام لایه‌ها حفظ می‌کند:

| جزء | تست‌ها | پوشش |
|-----|--------|-------|
| احراز هویت | 72+ | سناریوهای کامل با تست تقویت شده |
| مدیریت رستوران | 108+ | سرویس + مخزن + موجودیت |
| مدیریت آیتم | 120+ | سرویس + مخزن + موجودیت |
| مدیریت سفارش | 130+ | سرویس + مخزن + موجودیت |
| مدیریت منو | 80+ | سرویس + مخزن + موجودیت |
| سیستم پرداخت | 200+ | تست جامع پرداخت و کیف پول ✨ **جدید** |
| **مجموع** | **700+** | **همه موفق ✅** |

### دسته‌بندی تست‌ها
- **تست‌های واحد**: تست اجزای منفرد
- **تست‌های یکپارچگی**: تست تعامل بین اجزا
- **تست‌های مخزن**: تست عملیات پایگاه داده
- **تست‌های سرویس**: تست منطق تجاری
- **تست‌های موجودیت**: تست مدل‌های دامنه
- **تست‌های کنترلر**: تست REST API endpointها ✨ **جدید**
- **کلاس‌های تست تودرتو**: سازمان‌دهی تست‌ها بر اساس عملکرد
- **تست‌های پارامتری**: تست چندین سناریو

## 🏆 پیشرفت نیازمندی‌های دانشگاهی

### نیازمندی‌های فاز 1 (60 امتیاز):
1. ✅ **ثبت‌نام/ورود کاربر** (10 امتیاز) - کامل با تست جامع
2. ✅ **مدیریت پروفایل** (5 امتیاز) - کامل با CRUD کامل
3. ✅ **ثبت‌نام/فهرست رستوران** (5 امتیاز) - کامل با لایه سرویس کامل
4. ✅ **مدیریت منو توسط فروشندگان** (15 امتیاز) - کامل با لایه سرویس جامع
5. ✅ **قابلیت جستجوی غذا** (2.5 امتیاز) - کامل با جستجوی پیشرفته
6. ✅ **سبد خرید و ثبت سفارش** (5 امتیاز) - کامل با لایه سرویس کامل
7. ✅ **ارسال سفارش به فروشندگان** (2.5 امتیاز) - کامل با REST API ✨ **جدید**
8. ❌ **تخصیص پیک و تحویل** (7.5 امتیاز) - TODO
9. ✅ **تاریخچه سفارش** (2.5 امتیاز) - کامل با متدهای سرویس جامع
10. ❌ **داشبورد ادمین** (5 امتیاز) - TODO

### ویژگی‌های اضافی پیاده‌سازی شده:
11. ✅ **سیستم پرداخت کامل** (+10 امتیاز) - پردازش CARD, WALLET, COD ✨ **جدید**
12. ✅ **مدیریت کیف پول** (+5 امتیاز) - شارژ، برداشت، محدودیت‌ها ✨ **جدید**
13. ✅ **REST API کامل** (+10 امتیاز) - 60+ endpoint آماده برای مصرف فرانت‌اند ✨ **جدید**

**امتیاز فعلی: 47.5/60 امتیاز (79.2%) + 25 امتیاز اضافی = 72.5 امتیاز**

## 🔧 API Endpointهای پیاده‌سازی شده ✨ **جدید**

### احراز هویت
- `POST /api/auth/register` - ثبت‌نام کاربر
- `POST /api/auth/login` - ورود کاربر
- `GET /api/auth/profile` - دریافت پروفایل کاربر
- `PUT /api/auth/profile` - به‌روزرسانی پروفایل کاربر

### مدیریت رستوران
- `POST /api/restaurants` - ایجاد رستوران
- `GET /api/restaurants` - فهرست رستوران‌ها
- `PUT /api/restaurants/{id}` - به‌روزرسانی رستوران
- `GET /api/restaurants/{id}/status` - دریافت وضعیت رستوران
- `GET /api/restaurants/mine` - رستوران‌های من
- `GET /api/restaurants/{id}/menu` - منوی رستوران

### مدیریت منو
- `POST /api/restaurants/{id}/menu` - افزودن آیتم منو
- `GET /api/restaurants/{id}/menu` - دریافت منوی رستوران
- `PUT /api/menu/{itemId}` - به‌روزرسانی آیتم منو
- `DELETE /api/menu/{itemId}` - حذف آیتم منو
- `GET /api/menu/{itemId}/availability` - بررسی موجودی آیتم
- `PUT /api/menu/{itemId}/quantity` - به‌روزرسانی موجودی آیتم

### مدیریت سفارش
- `POST /api/orders` - ایجاد سفارش جدید
- `GET /api/orders/{id}` - دریافت جزئیات سفارش
- `PUT /api/orders/{id}/status` - به‌روزرسانی وضعیت سفارش
- `GET /api/orders/history` - دریافت تاریخچه سفارش
- `POST /api/orders/{id}/items` - افزودن آیتم به سفارش
- `PUT /api/orders/{id}/items/{itemId}` - به‌روزرسانی مقدار آیتم سفارش

### سیستم پرداخت ✨ **جدید**
- `POST /api/payments/process` - پردازش پرداخت
- `POST /api/payments/{id}/refund` - بازپرداخت
- `GET /api/payments/{id}` - دریافت جزئیات تراکنش
- `GET /api/payments/user/{userId}` - تاریخچه تراکنش کاربر
- `PUT /api/payments/{id}/status` - به‌روزرسانی وضعیت تراکنش
- `GET /api/payments/statistics/{userId}` - آمار تراکنش کاربر

### مدیریت کیف پول ✨ **جدید**
- `GET /api/wallet/balance/{userId}` - موجودی کیف پول
- `POST /api/wallet/charge` - شارژ کیف پول
- `POST /api/wallet/withdraw` - برداشت از کیف پول
- `GET /api/wallet/transactions/{userId}` - تاریخچه تراکنش‌های کیف پول
- `GET /api/wallet/statistics/{userId}` - آمار کیف پول
- `GET /api/wallet/sufficient/{userId}` - بررسی کفایت موجودی

### جستجوی غذا
- `GET /api/search?keyword={keyword}` - جستجوی آیتم‌های غذا
- `GET /api/search?category={category}` - فیلتر بر اساس دسته‌بندی

## 📈 معیارهای عملکرد

- **زمان اجرای تست**: ~45 ثانیه برای 700+ تست
- **عملیات پایگاه داده**: بهینه‌سازی شده با کش L2 هایبرنیت
- **استفاده از حافظه**: بارگذاری کارآمد موجودیت با lazy initialization
- **زمان ساخت**: ~25 ثانیه برای compile تمیز
- **لایه سرویس**: منطق تجاری کامل با اعتبارسنجی
- **REST API**: 60+ endpoint آماده برای مصرف فرانت‌اند ✨ **جدید**

## 🔍 کیفیت کد

### بهترین روش‌های پیاده‌سازی شده
- **توسعه مبتنی بر تست**: تمام ویژگی‌ها ابتدا با تست توسعه یافته
- **معماری لایه‌ای**: جداسازی واضح نگرانی‌ها
- **طراحی مبتنی بر دامنه**: مدل‌های دامنه غنی با منطق تجاری
- **مدیریت استثنا**: مدیریت خطای جامع در سراسر سیستم
- **مستندات کد**: نظرات و مستندات جامع
- **اعتبارسنجی منطق تجاری**: اعتبارسنجی ورودی کامل و قوانین تجاری
- **REST API طراحی**: endpointهای RESTful با مدیریت JSON ✨ **جدید**

### الگوهای طراحی
- **الگوی Repository**: انتزاع دسترسی به داده
- **الگوی لایه سرویس**: کپسوله‌سازی منطق تجاری
- **الگوی Factory**: ایجاد موجودیت با اعتبارسنجی
- **الگوی Builder**: ساخت اشیاء پیچیده
- **الگوی Controller**: مدیریت درخواست/پاسخ HTTP ✨ **جدید**

## 🚦 گردش کار توسعه

### استراتژی توسعه فازی
1. **فاز 1**: مهاجرت JPA و طراحی موجودیت ✅
2. **فاز 2**: لایه Repository و عملیات داده ✅
3. **فاز 3**: لایه Service و منطق تجاری ✅
4. **فاز 4**: لایه Controller و API Endpointها ✅ ✨ **تکمیل شده**
5. **فاز 5**: توسعه فرانت‌اند 🔄

### استراتژی تست
- **تست‌های واحد**: تست اجزای منفرد در انزوا
- **تست‌های یکپارچگی**: تست تعامل اجزا
- **تست‌های انتها به انتها**: تست گردش‌کارهای کامل کاربر
- **تست‌های پارامتری**: تست چندین سناریو به طور کارآمد
- **کلاس‌های تست تودرتو**: سازمان‌دهی تست‌ها بر اساس عملکرد

### دستاوردهای اخیر ✨
- **پیاده‌سازی سیستم پرداخت**: سیستم کامل پرداخت و کیف پول با 200+ تست
- **پیاده‌سازی REST API**: 60+ endpoint آماده برای مصرف فرانت‌اند
- **تکمیل لایه Controller**: 5 controller اصلی با مدیریت JSON کامل
- **تقویت مدیریت خطا**: کدهای وضعیت HTTP سازگار در تمام APIها
- **بلوغ معماری**: جداسازی تمیز بین لایه‌های داده، سرویس و کنترلر
- **تست جامع Controller**: تست کامل تمام REST API endpointها


## 📄 مجوز
این پروژه به عنوان تکلیف دانشگاهی برای درس برنامه‌نویسی پیشرفته توسعه یافته است.

## 👥 تیم
**توسعه‌دهنده**: مهراد مهدوی , امیرحسین پوری  
**درس**: برنامه‌نویسی پیشرفته  
**مؤسسه**: دانشگاه صنعتی امیر کبیر
**ترم**: نیم ترم دوم سال تحصیلی 1403
