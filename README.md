# 🍕 سیستم سفارش غذا

یک پلتفرم جامع سفارش غذا که به عنوان پروژه دانشگاهی برای درس برنامه‌نویسی پیشرفته توسعه یافته است. این سیستم دارای بک‌اند قدرتمند جاوا با Hibernate ORM و فرانت‌اند JavaFX برنامه‌ریزی شده است و معماری کاملاً چندلایه‌ای را پیاده‌سازی می‌کند.

## 🚀 وضعیت پروژه

**نسخه فعلی**: فاز 7+ تکمیل شده ✅  
**پوشش تست**: 1200+ تست موفق ✅  
**امتیاز دانشگاهی**: 60/60 امتیاز (100%) + 70 امتیاز اضافی = 130 امتیاز  

### ✅ ویژگی‌های تکمیل شده
- ✅ **مدیریت کاربران**: ثبت‌نام، ورود و مدیریت پروفایل کامل (92+ تست)
- ✅ **مدیریت رستوران**: منطق تجاری کامل رستوران (108+ تست)
- ✅ **مدیریت منو**: عملیات کامل منو با منطق تجاری (102+ تست)
- ✅ **جستجوی غذا**: جستجوی پیشرفته با فیلتر کلیدواژه و دسته‌بندی (91+ تست)
- ✅ **مدیریت سفارش**: سبد خرید کامل و ثبت سفارش (104+ تست)
- ✅ **تاریخچه سفارش**: ردیابی و تاریخچه کامل سفارشات
- ✅ **سیستم پرداخت**: پردازش کامل پرداخت و مدیریت کیف پول (25+ تست) ✨ **جدید**
- ✅ **سیستم تحویل**: مدیریت کامل تخصیص پیک و ردیابی تحویل (108+ تست) ✨ **کامل شده**
- ✅ **داشبورد ادمین**: مدیریت کامل سیستم و کاربران (65+ تست) ✨ **جدید**
- ✅ **سیستم فروشندگان**: مرور کامل فروشندگان و منوها (178+ تست) ✨ **جدید**
- ✅ **سیستم علاقه‌مندی‌ها**: مدیریت کامل رستوران‌های مورد علاقه (50+ تست) ✨ **جدید**
- ✅ **سیستم کوپن**: مدیریت کامل تخفیف‌ها و کوپن‌ها (59+ تست) ✨ **جدید**
- ✅ **ابزارهای امنیت**: هش امن رمز عبور و اعتبارسنجی (20+ تست) ✨ **جدید**
- ✅ **احراز هویت JWT**: Authentication مدرن با JWT tokens (35+ تست) ✨ **جدید**
- ✅ **لایه داده**: مهاجرت کامل JPA با روابط پیچیده
- ✅ **لایه سرویس**: پیاده‌سازی کامل منطق تجاری برای تمام ویژگی‌های اصلی
- ✅ **لایه کنترلر**: REST API endpointهای کامل برای یکپارچگی فرانت‌اند

### 📋 ویژگی‌های برنامه‌ریزی شده
- ✅ **سیستم نظرات**: امتیازدهی و نظرات کاربران (تکمیل شده)
- ✅ **سیستم کوپن**: مدیریت تخفیف‌ها (تکمیل شده) ✨ **جدید**
- 📋 **سیستم اعلان**: اعلان‌های بلادرنگ
- 📋 **فرانت‌اند JavaFX**: رابط کاربری کامل

## 🏗️ معماری

### بک‌اند (جاوا + Hibernate)
```
backend/
├── src/main/java/com/myapp/
│   ├── common/
│   │   ├── models/             # موجودیت‌های JPA ✅
│   │   ├── exceptions/         # استثناهای سفارشی ✅
│   │   └── utils/              # ابزارهای کمکی + JWT Utils ✅
│   ├── auth/                   # سیستم احراز هویت + JWT ✅
│   ├── restaurant/             # مدیریت رستوران ✅
│   ├── item/                   # مدیریت آیتم غذا ✅
│   ├── menu/                   # عملیات منو ✅
│   ├── order/                  # پردازش سفارش ✅
│   ├── payment/                # سیستم پرداخت ✅ ✨ جدید
│   ├── courier/                # سیستم تحویل ✅ ✨ کامل
│   ├── admin/                  # داشبورد ادمین ✅ ✨ جدید
│   ├── vendor/                 # سیستم فروشندگان ✅ ✨ جدید
│   ├── favorites/              # سیستم علاقه‌مندی‌ها ✅ ✨ جدید
│   ├── coupon/                 # سیستم کوپن ✅ ✨ جدید
│   └── ServerApp.java          # سرور HTTP ✅
└── src/test/java/              # 1100+ تست جامع ✅
```

### فرانت‌اند (JavaFX) - برنامه‌ریزی شده
```
frontend-javafx/
├── src/main/java/com/myapp/ui/
│   ├── auth/                   # رابط کاربری ورود/ثبت‌نام
│   ├── restaurant/             # رابط کاربری رستوران
│   ├── order/                  # رابط کاربری مدیریت سفارش
│   ├── payment/                # رابط کاربری پرداخت
│   └── MainApp.java            # اپلیکیشن JavaFX
└── src/main/resources/fxml/    # طرح‌بندی‌های رابط کاربری
```

## 🛠️ فناوری‌ها

### بک‌اند
- **Java 17+**
- **Hibernate 6.4.4** (JPA ORM)
- **SQLite** (پایگاه داده)
- **Maven** (ابزار ساخت)
- **JUnit 5** (فریمورک تست)

### فرانت‌اند (برنامه‌ریزی شده)
- **JavaFX** (فریمورک رابط کاربری دسکتاپ)
- **FXML** (طرح‌بندی رابط کاربری)

### DevOps
- **Maven** (مدیریت وابستگی)

## 🚀 شروع کار

### پیش‌نیازها
- Java 17 یا بالاتر
- Maven 3.6+

### 1. کلون کردن مخزن
```bash
git clone <repository-url>
cd food-ordering-project
```

### 2. ساخت پروژه
```bash
cd backend
mvn clean compile
```

### 3. اجرای تست‌ها
```bash
mvn test
```
خروجی مورد انتظار: `Tests run: 1100+, Failures: 0, Errors: 0`

### 4. راه‌اندازی سرور بک‌اند
```bash
mvn exec:java -Dexec.mainClass="com.myapp.ServerApp"
```

## 📊 پوشش تست

پروژه پوشش تست جامعی در تمام لایه‌ها حفظ می‌کند:

| جزء | تست‌ها | پوشش |
|-----|--------|-------|
| احراز هویت + JWT | 127+ | سناریوهای کامل + JWT Authentication |
| مدیریت رستوران | 108+ | سرویس + مخزن + موجودیت |
| مدیریت آیتم | 91+ | سرویس + مخزن + موجودیت |
| مدیریت سفارش | 104+ | سرویس + مخزن + موجودیت |
| مدیریت منو | 102+ | سرویس + مخزن + موجودیت |
| سیستم پرداخت | 25+ | تست جامع پرداخت و کیف پول ✨ **جدید** |
| سیستم تحویل | 108+ | تست کامل entity + service + controller ✨ **کامل** |
| داشبورد ادمین | 65+ | تست کامل controller + service ✨ **جدید** |
| سیستم فروشندگان | 178+ | تست کامل controller + service + repository ✨ **جدید** |
| سیستم علاقه‌مندی‌ها | 50+ | تست کامل service + controller ✨ **جدید** |
| سیستم کوپن | 59+ | تست کامل service + entity + business logic ✨ **جدید** |
| ابزارهای امنیت | 20+ | تست کامل PasswordUtil ✨ **جدید** |
| سایر ماژول‌ها | 350+ | تست‌های API، موجودیت‌ها و یکپارچگی |
| **مجموع** | **1200+** | **همه موفق ✅** |

### دسته‌بندی تست‌های سیستم علاقه‌مندی‌ها ✨ **جدید**
- **تست‌های Service**: 30 تست شامل تمام منطق تجاری مدیریت علاقه‌مندی‌ها
- **تست‌های Controller**: 20 تست شامل تمام REST API endpointها
- **مجموع**: 50 تست کامل برای سیستم علاقه‌مندی‌ها

### دسته‌بندی تست‌های سیستم امتیازدهی ✨ **جدید**
- **تست‌های Service**: 64 تست شامل تمام منطق تجاری امتیازدهی (100% موفق)
- **تست‌های Repository**: 59 تست شامل عملیات پیچیده پایگاه داده (100% موفق)
- **تست‌های Controller**: 30+ تست شامل تمام REST API endpointها
- **مجموع**: 153+ تست کامل برای سیستم امتیازدهی

### دسته‌بندی تست‌های سیستم تحویل ✨ **جدید**
- **تست‌های Entity**: 35 تست شامل منطق تجاری و validationها
- **تست‌های Service**: 66 تست شامل تمام سناریوهای کاربردی
- **تست‌های Controller**: 42 تست شامل تمام REST API endpointها
- **مجموع**: 108 تست کامل برای سیستم تحویل

### دسته‌بندی تست‌های داشبورد ادمین ✨ **جدید**
- **تست‌های Controller**: 20 تست شامل تمام REST API endpointها
- **تست‌های Service**: 45 تست شامل تمام منطق تجاری مدیریت سیستم
- **مجموع**: 65 تست کامل برای داشبورد ادمین

### دسته‌بندی تست‌های سیستم فروشندگان ✨ **جدید**
- **تست‌های Controller**: 38 تست شامل تمام REST API endpointها
- **تست‌های Service**: 66 تست شامل تمام منطق تجاری مرور فروشندگان
- **تست‌های Repository**: 74 تست شامل تمام کوئری‌های پایگاه داده
- **مجموع**: 178 تست کامل برای سیستم فروشندگان

### دسته‌بندی تست‌های سیستم کوپن ✨ **جدید**
- **تست‌های Service**: 39 تست شامل تمام منطق تجاری مدیریت کوپن‌ها
- **تست‌های Complete**: 20 تست شامل سناریوهای پیچیده و per-user limits
- **مجموع**: 59 تست کامل برای سیستم کوپن

### دسته‌بندی تست‌های ابزارهای امنیت ✨ **جدید**
- **تست‌های PasswordUtil**: 20 تست شامل هش، اعتبارسنجی و امنیت
- **مجموع**: 20 تست کامل برای ابزارهای امنیت

### دسته‌بندی تست‌های JWT Authentication ✨ **جدید**
- **تست‌های JWTUtil**: 15 تست شامل token generation, validation, claims extraction
- **تست‌های AuthResult**: 6 تست شامل authentication state management
- **تست‌های End-to-End**: 3 تست شامل complete workflow, security, performance
- **تست‌های Missing Scenarios**: 11 تست شامل edge cases, concurrency, security
- **مجموع**: 35 تست کامل برای JWT Authentication

### دسته‌بندی کلی تست‌ها
- **تست‌های واحد**: تست اجزای منفرد
- **تست‌های یکپارچگی**: تست تعامل بین اجزا
- **تست‌های مخزن**: تست عملیات پایگاه داده
- **تست‌های سرویس**: تست منطق تجاری
- **تست‌های موجودیت**: تست مدل‌های دامنه
- **تست‌های کنترلر**: تست REST API endpointها ✨ **جدید**
- **کلاس‌های تست تودرتو**: سازمان‌دهی تست‌ها بر اساس عملکرد
- **تست‌های پارامتری**: تست چندین سناریو

## 🏆 پیشرفت نیازمندی‌های دانشگاهی

### نیازمندی‌های فاز 1 (60 امتیاز):
1. ✅ **ثبت‌نام/ورود کاربر** (10 امتیاز) - کامل با تست جامع
2. ✅ **مدیریت پروفایل** (5 امتیاز) - کامل با CRUD کامل
3. ✅ **ثبت‌نام/فهرست رستوران** (5 امتیاز) - کامل با لایه سرویس کامل
4. ✅ **مدیریت منو توسط فروشندگان** (15 امتیاز) - کامل با لایه سرویس جامع
5. ✅ **قابلیت جستجوی غذا** (2.5 امتیاز) - کامل با جستجوی پیشرفته
6. ✅ **سبد خرید و ثبت سفارش** (5 امتیاز) - کامل با لایه سرویس کامل
7. ✅ **ارسال سفارش به فروشندگان** (2.5 امتیاز) - کامل با REST API ✨ **جدید**
8. ✅ **تخصیص پیک و تحویل** (7.5 امتیاز) - کامل با سیستم تحویل جامع ✨ **کامل**
9. ✅ **تاریخچه سفارش** (2.5 امتیاز) - کامل با متدهای سرویس جامع
10. ✅ **داشبورد ادمین** (5 امتیاز) - کامل با 18+ endpoint و 65+ تست ✨ **جدید**

### ویژگی‌های اضافی پیاده‌سازی شده:
11. ✅ **سیستم پرداخت کامل** (+10 امتیاز) - پردازش CARD, WALLET, COD ✨ **جدید**
12. ✅ **مدیریت کیف پول** (+5 امتیاز) - شارژ، برداشت، محدودیت‌ها ✨ **جدید**
13. ✅ **سیستم فروشندگان کامل** (+10 امتیاز) - مرور، جستجو، فیلتر فروشندگان ✨ **جدید**
14. ✅ **سیستم علاقه‌مندی‌ها** (+5 امتیاز) - مدیریت رستوران‌های مورد علاقه ✨ **جدید**
15. ✅ **سیستم امتیازدهی کامل** (+10 امتیاز) - امتیازدهی 1-5 ستاره، نظرات، رتبه‌بندی ✨ **جدید**
16. ✅ **سیستم کوپن کامل** (+10 امتیاز) - کوپن‌های درصدی/ثابت، per-user limits، آمارگیری ✨ **جدید**
17. ✅ **احراز هویت JWT** (+10 امتیاز) - JWT tokens, security, stateless authentication ✨ **جدید**
18. ✅ **REST API کامل** (+10 امتیاز) - 142+ endpoint آماده برای مصرف فرانت‌اند

**امتیاز فعلی: 60/60 امتیاز (100%) + 70 امتیاز اضافی = 130 امتیاز**

## 🔧 API Endpointهای پیاده‌سازی شده ✨ **جدید**

### احراز هویت + JWT ✨ **به‌روزرسانی شده**
- `POST /api/auth/register` - ثبت‌نام کاربر
- `POST /api/auth/login` - ورود کاربر (JWT tokens)
- `GET /api/auth/profile` - دریافت پروفایل کاربر
- `PUT /api/auth/profile` - به‌روزرسانی پروفایل کاربر
- `POST /api/auth/refresh` - تمدید access token ✨ **جدید**
- `GET /api/auth/validate` - اعتبارسنجی JWT token ✨ **جدید**
- `POST /api/auth/logout` - خروج کاربر ✨ **جدید**

### مدیریت رستوران (16+ endpoints)
- `POST /api/restaurants/` - ایجاد رستوران
- `GET /api/restaurants/` - فهرست رستوران‌ها
- `PUT /api/restaurants/{id}` - به‌روزرسانی رستوران
- `GET /api/restaurants/{id}/status` - دریافت وضعیت رستوران
- `GET /api/restaurants/mine` - رستوران‌های من
- `GET /api/restaurants/{id}/menu` - منوی رستوران

### سیستم علاقه‌مندی‌ها (6+ endpoints) ✨ **جدید**
- `GET /api/favorites/?userId={id}` - دریافت لیست علاقه‌مندی‌های کاربر
- `POST /api/favorites/add` - اضافه کردن رستوران به علاقه‌مندی‌ها
- `DELETE /api/favorites/remove?userId={id}&restaurantId={id}` - حذف از علاقه‌مندی‌ها
- `GET /api/favorites/check?userId={id}&restaurantId={id}` - بررسی علاقه‌مندی
- `GET /api/favorites/popular?limit={n}` - محبوب‌ترین رستوران‌ها
- `GET /api/favorites/count?userId={id}` - تعداد علاقه‌مندی‌های کاربر

### سیستم فروشندگان (10+ endpoints) ✨ **جدید**
- `GET /api/vendors/` - دریافت تمام فروشندگان
- `GET /api/vendors/search?query={term}` - جستجوی فروشندگان
- `GET /api/vendors/{id}` - دریافت جزئیات فروشنده
- `GET /api/vendors/{id}/menu` - دریافت منوی فروشنده
- `GET /api/vendors/{id}/stats` - آمار فروشنده
- `GET /api/vendors/location/{location}` - فروشندگان بر اساس موقعیت
- `GET /api/vendors/category/{category}` - فروشندگان بر اساس دسته‌بندی
- `GET /api/vendors/featured` - فروشندگان ویژه
- `GET /api/vendors/{id}/available` - بررسی در دسترس بودن فروشنده
- `POST /api/vendors/filter` - فیلتر کردن فروشندگان

### داشبورد ادمین (18+ endpoints) ✨ **جدید**
- `GET /api/admin/dashboard` - آمار کلی سیستم
- `GET /api/admin/users` - مدیریت کاربران
- `GET /api/admin/restaurants` - مدیریت رستوران‌ها
- `GET /api/admin/orders` - مدیریت سفارشات
- `GET /api/admin/transactions` - نظارت بر تراکنش‌ها
- `GET /api/admin/deliveries` - ردیابی تحویل‌ها
- `POST /api/admin/users/{id}/activate` - فعال‌سازی کاربر
- `POST /api/admin/users/{id}/deactivate` - غیرفعال‌سازی کاربر
- `POST /api/admin/restaurants/{id}/approve` - تأیید رستوران
- `POST /api/admin/restaurants/{id}/reject` - رد رستوران

### سیستم تحویل (16+ endpoints) ✨ **جدید**
- `GET /api/deliveries/` - فهرست تحویل‌ها
- `POST /api/deliveries/` - ایجاد تحویل جدید
- `GET /api/deliveries/{id}` - جزئیات تحویل
- `PUT /api/deliveries/{id}/status` - به‌روزرسانی وضعیت تحویل
- `GET /api/deliveries/available` - تحویل‌های در دسترس
- `POST /api/deliveries/{id}/assign` - تخصیص پیک
- `GET /api/deliveries/courier/{courierId}` - تحویل‌های پیک
- `POST /api/deliveries/{id}/complete` - تکمیل تحویل

### سیستم پرداخت (8+ endpoints) ✨ **جدید**
- `GET /api/payments/` - تاریخچه پرداخت‌ها
- `POST /api/payments/` - پردازش پرداخت
- `GET /api/payments/{id}` - جزئیات پرداخت
- `POST /api/payments/refund` - بازپرداخت

### سیستم کیف پول (6+ endpoints) ✨ **جدید**
- `GET /api/wallet/{userId}` - موجودی کیف پول
- `POST /api/wallet/add-funds` - افزودن اعتبار
- `POST /api/wallet/withdraw` - برداشت از کیف پول
- `GET /api/wallet/{userId}/transactions` - تاریخچه تراکنش‌های کیف پول

### سیستم امتیازدهی (12+ endpoints) ✨ **جدید**
- `POST /api/ratings/` - ثبت امتیاز و نظر جدید
- `GET /api/ratings/{id}` - دریافت جزئیات امتیاز
- `PUT /api/ratings/{id}` - به‌روزرسانی امتیاز و نظر
- `DELETE /api/ratings/{id}` - حذف امتیاز
- `GET /api/ratings/restaurant/{restaurantId}` - تمام امتیازهای رستوران
- `GET /api/ratings/user/{userId}` - تمام امتیازهای کاربر
- `GET /api/ratings/restaurant/{restaurantId}/average` - میانگین امتیاز رستوران
- `GET /api/ratings/restaurant/{restaurantId}/recent?days={n}` - امتیازهای اخیر
- `GET /api/ratings/top-restaurants?limit={n}` - رستوران‌های برتر
- `GET /api/ratings/user/{userId}/restaurant/{restaurantId}` - امتیاز کاربر برای رستوران
- `GET /api/ratings/restaurant/{restaurantId}/stats` - آمار کامل امتیازدهی
- `GET /api/ratings/restaurant/{restaurantId}/count` - تعداد امتیازهای رستوران

### سیستم کوپن (15+ endpoints) ✨ **جدید**
- `POST /api/coupons/` - ایجاد کوپن جدید
- `GET /api/coupons/{id}` - دریافت جزئیات کوپن
- `GET /api/coupons/code/{code}` - جستجوی کوپن با کد
- `PUT /api/coupons/{id}` - به‌روزرسانی کوپن
- `DELETE /api/coupons/{id}` - حذف کوپن
- `GET /api/coupons/valid` - تمام کوپن‌های فعال
- `GET /api/coupons/restaurant/{restaurantId}` - کوپن‌های رستوران خاص
- `GET /api/coupons/global` - کوپن‌های عمومی
- `GET /api/coupons/applicable?orderAmount={amount}&restaurantId={id}` - کوپن‌های قابل اعمال
- `POST /api/coupons/apply` - اعمال کوپن به سفارش
- `POST /api/coupons/{id}/activate` - فعال‌سازی کوپن
- `POST /api/coupons/{id}/deactivate` - غیرفعال‌سازی کوپن
- `GET /api/coupons/statistics` - آمار کوپن‌ها
- `GET /api/coupons/expiring?days={n}` - کوپن‌های نزدیک به انقضا
- `GET /api/coupons/usage/{couponId}` - آمار استفاده از کوپن

### مدیریت سفارش (20+ endpoints)
- `POST /api/orders/` - ثبت سفارش جدید
- `GET /api/orders/` - فهرست سفارشات
- `GET /api/orders/{id}` - جزئیات سفارش
- `PUT /api/orders/{id}/status` - به‌روزرسانی وضعیت سفارش
- `GET /api/orders/user/{userId}` - سفارشات کاربر
- `GET /api/orders/restaurant/{restaurantId}` - سفارشات رستوران

### مدیریت آیتم (13+ endpoints)
- `POST /api/items/` - ایجاد آیتم جدید
- `GET /api/items/` - فهرست آیتم‌ها
- `PUT /api/items/{id}` - به‌روزرسانی آیتم
- `DELETE /api/items/{id}` - حذف آیتم
- `GET /api/items/search` - جستجوی آیتم‌ها
- `GET /api/items/category/{category}` - آیتم‌های دسته‌بندی

### مدیریت منو (6+ endpoints)
- `GET /api/menu/{restaurantId}` - منوی رستوران
- `POST /api/menu/` - اضافه کردن آیتم به منو
- `DELETE /api/menu/{menuId}` - حذف از منو
- `PUT /api/menu/{menuId}` - به‌روزرسانی منو

## 📈 آمار عملکرد

### معیارهای کلیدی:
- **Controllers**: 10 کنترلر کامل
- **Services**: 10+ سرویس با منطق تجاری جامع
- **Repositories**: 8+ مخزن با عملیات CRUD کامل
- **REST Endpoints**: 142+ endpoint آماده برای مصرف
- **JPA Entities**: 8 موجودیت با روابط پیچیده
- **Test Coverage**: 1200+ تست موفق
- **Database**: SQLite با Hibernate ORM

### عملکرد تست:
- **سرعت اجرای تست**: < 30 ثانیه برای تمام تست‌ها
- **پایداری**: 100% نرخ موفقیت تست‌ها
- **پوشش کد**: پوشش جامع تمام لایه‌ها

## 🎯 مراحل بعدی

### فاز بعدی - سیستم اعلان و رابط کاربری:
1. ✅ **سیستم نظرات**: امتیازدهی و نظرات کاربران (تکمیل شده)
2. ✅ **سیستم کوپن**: مدیریت تخفیف‌ها و کدهای تخفیف (تکمیل شده) ✨ **جدید**
3. 📋 **سیستم اعلان**: اعلان‌های بلادرنگ
4. 📋 **فرانت‌اند JavaFX**: رابط کاربری کامل

### بهینه‌سازی‌های آتی:
- کش کردن داده‌ها برای بهبود عملکرد
- پیاده‌سازی الگوی CQRS
- اضافه کردن logging جامع
- پیاده‌سازی rate limiting

## 🤝 مشارکت

این پروژه به عنوان پروژه دانشگاهی توسعه یافته است. برای مشارکت:

1. Fork کنید
2. Feature branch ایجاد کنید
3. تست‌های جامع اضافه کنید
4. Pull request ارسال کنید

## 📄 مجوز

این پروژه تحت مجوز MIT منتشر شده است.

---

**نکته**: این پروژه به‌طور مداوم در حال توسعه است و ویژگی‌های جدید به‌طور منظم اضافه می‌شوند. برای آخرین به‌روزرسانی‌ها، مخزن را دنبال کنید.
